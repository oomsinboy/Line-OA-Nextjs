(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[527],{68259:function(e,t,a){Promise.resolve().then(a.bind(a,52682))},57818:function(e,t,a){"use strict";a.d(t,{default:function(){return l.a}});var s=a(50551),l=a.n(s)},50551:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n}});let s=a(99920);a(57437),a(2265);let l=s._(a(40148));function n(e,t){var a;let s={loading:e=>{let{error:t,isLoading:a,pastDelay:s}=e;return null}};"function"==typeof e&&(s.loader=e);let n={...s,...t};return(0,l.default)({...n,modules:null==(a=n.loadableGenerated)?void 0:a.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},10912:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return l}});let s=a(55592);function l(e){let{reason:t,children:a}=e;if("undefined"==typeof window)throw new s.BailoutToCSRError(t);return a}},40148:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return c}});let s=a(57437),l=a(2265),n=a(10912),i=a(61481);function r(e){return{default:e&&"default"in e?e.default:e}}let d={loader:()=>Promise.resolve(r(()=>null)),loading:null,ssr:!0},c=function(e){let t={...d,...e},a=(0,l.lazy)(()=>t.loader().then(r)),c=t.loading;function o(e){let r=c?(0,s.jsx)(c,{isLoading:!0,pastDelay:!0,error:null}):null,d=t.ssr?(0,s.jsxs)(s.Fragment,{children:["undefined"==typeof window?(0,s.jsx)(i.PreloadCss,{moduleIds:t.modules}):null,(0,s.jsx)(a,{...e})]}):(0,s.jsx)(n.BailoutToCSR,{reason:"next/dynamic",children:(0,s.jsx)(a,{...e})});return(0,s.jsx)(l.Suspense,{fallback:r,children:d})}return o.displayName="LoadableComponent",o}},61481:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return n}});let s=a(57437),l=a(58512);function n(e){let{moduleIds:t}=e;if("undefined"!=typeof window)return null;let a=(0,l.getExpectedRequestStore)("next/dynamic css"),n=[];if(a.reactLoadableManifest&&t){let e=a.reactLoadableManifest;for(let a of t){if(!e[a])continue;let t=e[a].files.filter(e=>e.endsWith(".css"));n.push(...t)}}return 0===n.length?null:(0,s.jsx)(s.Fragment,{children:n.map(e=>(0,s.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:a.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}},52682:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return Y}});var s=a(57437),l=a(86504),n=a(2265),i=a(16463),r=a(38472),d=a(19212),c=a.n(d);a(55055),c().locale("th");var o=e=>{let{items:t}=e;return(0,s.jsx)("div",{className:"px-8",children:(0,s.jsx)("div",{className:"h-full w-full rounded-[15px] bg-white p-5 flex justify-center",children:(0,s.jsxs)("div",{className:"min-h-[81.71dvh] w-[70%] flex flex-col",children:[(0,s.jsx)("div",{children:(0,s.jsx)("div",{className:"text-xl 2xl:text-2xl text-[#5955B3] font-semibold",children:"เพิ่มผู้ป่วยใหม่"})}),(0,s.jsxs)("form",{action:"",className:" mt-2",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{className:"w-1/2 pr-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"ชื่อ"}),(0,s.jsx)("label",{className:"bg-[#F8F5FB] input input-bordered flex items-center gap-2 w-full",children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",value:t.patient.patient_fname,readOnly:!0})})]})}),(0,s.jsx)("div",{className:"w-1/2 pl-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"นามสกุล"}),(0,s.jsx)("label",{className:"bg-[#F8F5FB] input input-bordered flex items-center gap-2 w-full",children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",value:t.patient.patient_lname,readOnly:!0})})]})})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{className:"w-1/2 pr-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"เลขที่บัตรประจำตัวประชาชน"}),(0,s.jsx)("label",{className:"bg-[#F8F5FB] input input-bordered flex items-center gap-2 w-full",children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",value:t.patient.id_card,maxLength:13,pattern:"\\d{13}",readOnly:!0})})]})}),(0,s.jsx)("div",{className:"w-1/2 pl-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"วันเดือนปีเกิด"}),(0,s.jsx)("label",{className:"bg-[#F8F5FB] input input-bordered flex items-center gap-2 w-full",children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",value:t.patient.dob?c()(t.patient.dob).add(543,"years").format("DD-MM-YYYY"):"",readOnly:!0})})]})})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{className:"w-1/2 pr-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"วันที่ลงทะเบียน"}),(0,s.jsx)("label",{className:" bg-[#F8F5FB] input input-bordered flex items-center gap-2 w-full",children:(0,s.jsx)("input",{type:"text",className:"grow pointer-events-none text-[#705396]",value:c().utc(t.patient.register_date).add(543,"years").format("DD-MM-YYYY HH:mm:ss"),readOnly:!0})})]})}),(0,s.jsx)("div",{className:"w-1/2 pl-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"วันนัดหมาย"}),(0,s.jsxs)("div",{className:"flex justify-between gap-2",children:[(0,s.jsx)("label",{className:"bg-[#F8F5FB] input input-bordered flex items-center gap-2 w-1/2",children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",value:c()(t.patient.appointment_date).format("DD-MM-")+(c()(t.patient.appointment_date).year()+543),readOnly:!0})}),(0,s.jsx)("label",{className:"bg-[#F8F5FB] input input-bordered flex items-center gap-2 w-1/2",children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",value:c()(t.patient.appointment_time,"HH:mm:ss").format("HH:mm:ss"),readOnly:!0})})]})]})})]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsxs)("div",{className:"my-2 w-1/2 pr-4",children:[(0,s.jsx)("div",{className:"flex",children:(0,s.jsx)("span",{className:"text-[#705396]",children:"เลือกยาที่ต้องหยุดรับประทาน"})}),(0,s.jsxs)("div",{className:"rounded bg-[#E8DBF5] min-h-[36dvh] 2xl:min-h-[40dvh] p-3",children:[(0,s.jsxs)("span",{className:"text-[#705396]",children:[" รายการที่เลือก ",t.patient.med.length," รายการ"]}),(0,s.jsx)("div",{className:"max-h-[30dvh] 2xl:max-h-[35dvh] overflow-y-auto",children:t.patient.med.map((e,t)=>(0,s.jsxs)("div",{className:"flex justify-between pt-2",children:[(0,s.jsx)("select",{className:"w-[70%] mx-1 h-[3rem] rounded bg-[#F8F5FB] text-center text-[#705396]",defaultValue:e.medic,disabled:!0,children:(0,s.jsx)("option",{value:e.medic,children:e.medic})}),(0,s.jsx)("select",{className:"w-[20%] mx-1 h-[3rem] rounded text-center text-[#705396]",defaultValue:e.val,disabled:!0,children:(0,s.jsx)("option",{value:e.val,children:e.val})}),(0,s.jsx)("span",{className:"flex items-center text-[#705396]",children:"วัน"})]},t))})]})]}),(0,s.jsx)("div",{className:"w-1/2 pl-4 flex justify-center items-center",children:(0,s.jsxs)("div",{className:"text-center w-1/2",children:[(0,s.jsx)("div",{className:"text-[#461F78] text-3xl font-semibold my-2",children:"OTP"}),(0,s.jsx)("div",{className:"text-[#705396] my-2",children:"รหัสนี้ใช้สำหรับลงทะเบียนผู้ใช้งาน Line OA"}),(0,s.jsx)("div",{className:"p-10 bg-[#F8F5FB] my-2",children:(0,s.jsx)("span",{className:"text-[#7F57D0] text-4xl tracking-widest",children:t.patient.otp})})]})})]})]})})})},x=a(46797),m=a(66648),p=e=>{let{isVisible:t,onClose:a,title:l,children:n}=e;return t?(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-20 flex justify-center items-center",children:(0,s.jsx)("div",{className:"w-[80%] animate-modalOpen",children:(0,s.jsxs)("div",{className:"relative bg-white p-3 rounded",children:[(0,s.jsx)("div",{className:"absolute right-2",children:(0,s.jsx)("button",{onClick:()=>a(),children:(0,s.jsx)(m.default,{src:"/image/icon_close.png",alt:"logo",width:30,height:30})})}),n]})})}):null},h=a(64379),u=a.n(h),f=a(57818);a(18416);var j=a(50448);let v=(0,f.default)(()=>Promise.all([a.e(70),a.e(436)]).then(a.t.bind(a,98436,23)),{loadableGenerated:{webpack:()=>[98436]},ssr:!1});c().locale("th");var g=e=>{let{visit_id:t,dailyDetail:a,notilist:l}=e,[i,d]=(0,n.useState)(!1),[o,x]=(0,n.useState)(null),[h,f]=(0,n.useState)(!1),[g,N]=(0,n.useState)(""),[b,w]=(0,n.useState)(0),[y,F]=(0,n.useState)(c()()),_=y.clone().startOf("month").startOf("week"),B=y.clone().endOf("month").endOf("week"),D=_.clone().subtract(1,"day"),O=[];for(;D.isBefore(B,"day");)O.push(Array(7).fill(0).map(()=>D.add(1,"day").clone()));let S=e=>e.isSame(y,"month"),C=e=>{x(e),N(e.noti_detail||""),d(!0)},Y=async()=>{let e=0===b?o.noti_id:b.toString(),a=new FormData;a.append("visit_id",t.toString()),a.append("noti_id",e),a.append("noti_detail",g);try{let e=await r.Z.post("".concat("https://colonoscopytuh.com/backend/api/","daily_noti/task/").concat(o.daily_id),a);200===e.status?(f(!1),u().fire({title:"สำเร็จ",text:"คุณได้การแก้ไขเรียบร้อยแล้ว",icon:"success",confirmButtonText:"ปิด"}).then(()=>{window.location.reload()})):u().fire({title:"ขออภัย",text:"คุณทำรายการไม่ถูกต้อง กรุณาตรวจสอบใหม่อีกครั้ง",icon:"warning",confirmButtonText:"ปิด",customClass:{icon:"custom-swal2-warning"}})}catch(e){console.error("Error saving data:",e),u().fire({title:"ขออภัย",text:"เกิดข้อผิดพลาดในการบันทึกข้อมูล กรุณาลองใหม่อีกครั้ง",icon:"error",confirmButtonText:"ปิด",customClass:{icon:"custom-swal2-error"}})}};return(0,s.jsxs)("div",{className:"pl-8 pt-4 2xl:pt-10",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center ",children:[(0,s.jsx)("button",{onClick:()=>{F(y.clone().subtract(1,"month"))},children:(0,s.jsx)(m.default,{src:"/image/icon_left.png",alt:"logo",width:15,height:15})}),(0,s.jsxs)("span",{className:"text-lg font-semibold text-[#BE77F1]",children:[y.format("MMMM")," ",y.year()+543]}),(0,s.jsx)("button",{onClick:()=>{F(y.clone().add(1,"month"))},children:(0,s.jsx)(m.default,{src:"/image/icon_right.png",alt:"logo",width:15,height:15})})]}),(()=>{let e=c().weekdays(!0);return(0,s.jsx)("div",{className:"grid grid-cols-7 bg-[#B498F0] text-white rounded mt-4",children:e.map(e=>(0,s.jsx)("div",{className:"text-center py-2",children:e},e))})})(),(0,s.jsx)("div",{className:"grid grid-cols-7",children:O.map((e,t)=>(0,s.jsx)("div",{className:"contents",children:e.map((e,t)=>{let l=a.some((t,s)=>c()(t.date_before_appointment).isSame(e,"day")&&s===a.length-1);return(0,s.jsxs)("div",{className:"relative flex justify-end items-end text-center h-[88px] 2xl:h-24 p-2 w-full border ".concat(S(e)?"":"text-gray-400"),children:[a.map((t,l)=>{if(c()(t.date_before_appointment).isSame(e,"day")){let n=0===l,i=c()().isSame(e,"day"),r=e.isBefore(c()(),"day");return(0,s.jsxs)("div",{children:[n&&(0,s.jsx)("div",{className:"w-[calc(100%-8px)] absolute top-1 left-1 text-white bg-[#BE77F1] p-1 rounded",children:"ลงทะเบียน"}),l===a.length-1?(0,s.jsx)("div",{className:"h-[calc(100%-8px)] w-[calc(100%-8px)] absolute top-1 left-1 text-center text-white p-1 rounded ".concat(i||!r?"bg-[#BE77F1]":"bg-[#AEB2B5]"),children:"ส่องกล้อง"}):(0,s.jsx)("button",{className:"absolute bottom-2 left-2 rounded text-white w-7 h-7 font-light flex justify-center items-center ".concat(n?"bg-[#AEB2B5] hover:bg-[#e5e7eb]":i||!r?"bg-[#705396] hover:bg-[#BE77F1]":"bg-[#AEB2B5] hover:bg-[#e5e7eb]"),onClick:()=>C(t),children:(0,s.jsx)(m.default,{className:"gap-2",src:n?"/image/icon_edit_pass.png":i||!r?"/image/icon_edit.png":"/image/icon_edit_pass.png",alt:"logo",width:20,height:20})})]},t.date_before_appointment)}return null}),(0,s.jsx)("div",{className:"absolute bottom-2 right-3 ".concat(l?"text-white":""),children:e.format("D")})]},t)})},t))}),(0,s.jsx)(p,{isVisible:i,onClose:()=>{d(!1),f(!1),N(o&&o.noti_detail||"")},title:"รายละเอียดการแจ้งเตือน",children:o&&(0,s.jsxs)("div",{className:"p-5",children:[(0,s.jsxs)("div",{className:"text-xl 2xl:text-2xl text-[#5955B3] font-semibold",children:["แจ้งเตือนคุณ ",o.ptname]}),(0,s.jsxs)("div",{className:"text-xl 2xl:text-2xl text-[#5955B3] font-semibold",children:["วันที่ ",c()(o.date_before_appointment).format("DD-MM-")+(c()(o.date_before_appointment).year()+543)]}),(0,s.jsx)("div",{className:"rounded ".concat(h?"bg-white py-2":" bg-[#E8DBF5] p-3","  min-h-[48dvh]  2xl:mt-2 text-xl mb-16"),children:h?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("select",{className:"w-full mb-4 p-2 border rounded",value:b,onChange:e=>{let t=parseInt(e.target.value,10);w(t);let a=l.find(e=>e.id===t);N(a?a.detail:"")},children:[(0,s.jsx)("option",{value:0,disabled:!0,children:"เลือกการแจ้งเตือน"}),l.map(e=>(0,s.jsx)("option",{value:e.id,children:e.header},e.id))]}),(0,s.jsx)(v,{className:"h-[280px] 2xl:h-[360px]",value:g,onChange:e=>N(e),theme:"snow"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"my-2",children:"ข้อควรปฏิบัติก่อนรับการตรวจส่องกล้องลำไส้ใหญ่"}),(0,s.jsx)("div",{className:"break-words max-h-[460px]",dangerouslySetInnerHTML:{__html:(0,j.X1)(o.noti_detail)||""}})]})}),o&&o.date_before_appointment!==a[0].date_before_appointment&&!c()(o.date_before_appointment).isBefore(c()(),"day")&&(0,s.jsx)("div",{className:"flex justify-center mt-4",children:(0,s.jsxs)("button",{onClick:h?Y:()=>{f(!0)},className:"relative text-white w-38 font-light btn btn-active mx-4 ".concat(h?"bg-[#693092]":"bg-[#AF88FF]"),children:[(0,s.jsx)(m.default,{className:"gap-2",src:h?"/image/icon_save.png":"/image/icon_edit.png",alt:"logo",width:30,height:30}),(0,s.jsx)("span",{children:h?"Save":"Edit"})]})})]})})]})},N=a(95065),b=a(81289),w=a(54952),y=a(72247),F=a(84721),_=a(62737),B=a.n(_);let D=(0,f.default)(()=>Promise.all([a.e(70),a.e(436)]).then(a.t.bind(a,98436,23)),{loadableGenerated:{webpack:()=>[98436]},ssr:!1});c().locale("th");var O=e=>{let{items:t,fetchDataview:a}=e,[l,i]=(0,n.useState)(!1),[d,o]=(0,n.useState)(t.patient.patient_fname),[x,h]=(0,n.useState)(t.patient.patient_lname),[f,v]=(0,n.useState)(t.patient.id_card),[_,O]=(0,n.useState)(B()(t.patient.dob)),[S,C]=(0,n.useState)(B()(t.patient.appointment_date)),[Y,M]=(0,n.useState)(c()(t.patient.appointment_time,"HH:mm")),[k,T]=(0,n.useState)(t.patient.line_name),[P,E]=(0,n.useState)([]),[H,Z]=(0,n.useState)([]),[L,A]=(0,n.useState)({}),[I,R]=(0,n.useState)({}),[V,W]=(0,n.useState)({}),[U,$]=(0,n.useState)(""),[G,X]=(0,n.useState)([]),[J,Q]=(0,n.useState)(!1),[q,z]=(0,n.useState)(null),[K,ee]=(0,n.useState)(""),[et,ea]=(0,n.useState)(0);(0,n.useEffect)(()=>{l||C(B()("".concat(t.patient.appointment_date.split("T")[0],"T").concat(t.patient.appointment_time)));let e=async()=>{try{let e=await r.Z.get("".concat("https://colonoscopytuh.com/backend/api/","notification"));X(e.data)}catch(e){console.error("Error fetching noti data:",e)}};(async()=>{try{let e=(await r.Z.get("".concat("https://colonoscopytuh.com/backend/api/","medical"))).data;if(Z(e),t.patient.med){let a=t.patient.med.map((t,a)=>{let s=e.some(e=>e.name===t.medic),l=/^[1-7]$/.test(t.val);return{id:a,name:t.medic,dose:t.val,isOther:!s,isDoseOther:!l}});E(a)}}catch(e){console.error("Error fetching medical data:",e)}})(),e()},[t.patient.med,t.patient.appointment_date,t.patient.appointment_time,l]);let es=e=>{E(P.filter(t=>t.id!==e))},el=(e,t)=>{let a=e.target.value;P.some(e=>e.name===a&&e.id!==t&&"other"!==a)?u().fire({title:"ขออภัย",text:"รายการยานี้ถูกเลือกแล้ว",icon:"error",confirmButtonText:"ปิด",customClass:{icon:"custom-swal2-error"}}):E(P.map(e=>{if(e.id===t){let t="other"===a||!H.some(e=>e.name===a);return{...e,name:a,isOther:t}}return e}))},en=(e,t)=>{A({...L,[t]:e.target.value}),E(P.map(a=>a.id===t?{...a,name:e.target.value}:a))},ei=(e,t)=>{R({...I,[t]:e.target.value}),E(P.map(a=>a.id===t?{...a,dose:e.target.value}:a))},er=(e,t)=>{let a=e.target.value;E(P.map(e=>e.id===t?{...e,dose:a,isDoseOther:"other"===a}:e))},ed=async()=>{let e={visit_id:t.patient.visit_id,userId:t.patient.line_id};try{let t=await r.Z.post("".concat("https://colonoscopytuh.com/backend/api/","visit/line/renew"),e);200===t.status?T(t.data.line_name):console.error("Failed to refresh data")}catch(e){console.error("Error while refreshing data:",e)}},ec=async()=>{let e=P.some(e=>!e.name||!e.dose),a=B()().startOf("day"),s=_?B()(_).startOf("day"):null,l=s?a.diff(s,"year"):null;if(e){$("กรุณากรอกข้อมูลยาและจำนวนวันที่รับประทานให้ครบถ้วน");return}$("");let n={};if(d.trim()||(n.firstname="กรุณากรอกชื่อ"),x.trim()||(n.lastname="กรุณากรอกนามสกุล"),f.trim()?13!==f.trim().length&&(n.idCard="กรุณากรอกบัตรประจำตัวประชาชนให้ถูกต้อง (13 หลัก)"):n.idCard="กรุณากรอกบัตรประจำตัวประชาชน",_?(null===l||l<1)&&(n.birthDate="กรุณากรอกวันเดือนปีเกิดที่มากกว่าหรือเท่ากับ 1 ปี"):n.birthDate="กรุณากรอกวันเดือนปีเกิด",Y||(n.appointmentTime="กรุณากรอกเวลานัดหมาย"),S){let e=c().utc(t.patient.register_date).startOf("day");5>S.diff(e,"days")&&(n.appointmentDate="กรุณากรอกวันนัดหมายที่มากกว่าวันลงทะเบียน 5 วัน")}else n.appointmentDate="กรุณากรอกวันนัดหมาย";if(Object.keys(n).length>0){W(n);return}W({}),await eo()},eo=async()=>{let e=JSON.stringify(P.map(e=>({val:e.dose,medic:e.name}))),a=new FormData;a.append("fname",d),a.append("lname",x),a.append("idcard",f),a.append("dob",_?_.format("YYYY-MM-DD"):""),a.append("appointment_date",S?S.format("YYYY-MM-DD"):""),a.append("appointment_time",Y?Y.format("HH:mm:ss"):""),a.append("patient_id",String(t.patient.patient_id)),a.append("med",e);try{let e=await r.Z.post("".concat("https://colonoscopytuh.com/backend/api/","visit/task/").concat(t.patient.visit_id),a);200===e.status?(i(!1),u().fire({title:"สำเร็จ",text:"คุณได้ทำการแก้ไขเรียบร้อยแล้ว",icon:"success",confirmButtonText:"ปิด"}).then(()=>{window.location.reload()})):u().fire({title:"ขออภัย",text:"คุณทำรายการไม่ถูกต้อง กรุณาตรวจสอบใหม่อีกครั้ง",icon:"warning",confirmButtonText:"ปิด",customClass:{icon:"custom-swal2-warning"}})}catch(e){console.error("Error saving data:",e),u().fire({title:"ขออภัย",text:"เกิดข้อผิดพลาดในการบันทึกข้อมูล กรุณาลองใหม่อีกครั้ง",icon:"error",confirmButtonText:"ปิด",customClass:{icon:"custom-swal2-error"}})}},ex=t.daily_detail.slice(1,t.daily_detail.length-1).some(e=>c()().isSame(e.date_before_appointment,"day")),em=e=>{z(e),ee(e.noti_detail||""),Q(!0)},ep=async()=>{let e=new FormData,a=0===et?q.noti_id:et.toString();e.append("visit_id",t.patient.visit_id.toString()),e.append("noti_id",a),e.append("noti_detail",K);try{let t=await r.Z.post("".concat("https://colonoscopytuh.com/backend/api/","daily_noti/task/").concat(q.daily_id),e);200===t.status?u().fire({title:"สำเร็จ",text:"คุณได้การแก้ไขเรียบร้อยแล้ว",icon:"success",confirmButtonText:"ปิด"}).then(()=>{window.location.reload()}):u().fire({title:"ขออภัย",text:"คุณทำรายการไม่ถูกต้อง กรุณาตรวจสอบใหม่อีกครั้ง",icon:"warning",confirmButtonText:"ปิด",customClass:{icon:"custom-swal2-warning"}})}catch(e){console.error("Error saving data:",e),u().fire({title:"ขออภัย",text:"เกิดข้อผิดพลาดในการบันทึกข้อมูล กรุณาลองใหม่อีกครั้ง",icon:"error",confirmButtonText:"ปิด",customClass:{icon:"custom-swal2-error"}})}};return(0,s.jsx)("div",{className:"px-8",children:(0,s.jsx)("div",{className:"h-full w-full rounded-[15px] bg-white p-5 ",children:(0,s.jsxs)("div",{className:"min-h-[81.71dvh] flex flex-col",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{children:(0,s.jsx)("div",{className:"text-xl 2xl:text-2xl text-[#5955B3] font-semibold",children:"ลงทะเบียนผู้ป่วย"})}),(0,s.jsx)("div",{className:"flex",children:(0,s.jsxs)("button",{onClick:l?ec:()=>{i(!0)},className:"relative text-white w-38 font-light btn btn-active mx-4 ".concat(l?"bg-[#693092]":"bg-[#AF88FF]"),children:[(0,s.jsx)(m.default,{className:"gap-2",src:l?"/image/icon_save.png":"/image/icon_edit.png",alt:"logo",width:30,height:30}),(0,s.jsx)("span",{children:l?"Save":"Edit"})]})})]}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsxs)("div",{className:" w-[55%]",children:[(0,s.jsxs)("form",{action:"",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{className:"w-1/2 pr-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"ชื่อ"}),(0,s.jsx)("label",{className:"".concat(l?"":"bg-[#F8F5FB]"," input input-bordered flex items-center gap-2 w-full"),children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",readOnly:!l,value:d,onChange:e=>o(e.target.value)})}),V.firstname&&(0,s.jsx)("span",{className:"text-red-500",children:V.firstname})]})}),(0,s.jsx)("div",{className:"w-1/2 pl-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396] ",children:"นามสกุล"}),(0,s.jsx)("label",{className:"".concat(l?"":"bg-[#F8F5FB]"," input input-bordered flex items-center gap-2 w-full"),children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",readOnly:!l,value:x,onChange:e=>h(e.target.value)})}),V.lastname&&(0,s.jsx)("span",{className:"text-red-500",children:V.lastname})]})})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{className:"w-1/2 pr-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"เลขที่บัตรประจำตัวประชาชน"}),(0,s.jsx)("label",{className:"".concat(l?"":"bg-[#F8F5FB]"," input input-bordered flex items-center gap-2 w-full"),children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",value:f,maxLength:13,pattern:"\\d{13}",readOnly:!l,onChange:e=>v(e.target.value)})}),V.idCard&&(0,s.jsx)("span",{className:"text-red-500",children:V.idCard})]})}),(0,s.jsx)("div",{className:"w-1/2 pl-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"วันเดือนปีเกิด"}),l?(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(w._,{dateAdapter:F.Z,adapterLocale:"th",children:(0,s.jsx)(N.O,{format:"DD-MM-YYYY",value:_,onChange:e=>O(e),slotProps:{textField:{fullWidth:!0,className:" text-[#705396] hover:border-gray-500 h-[48px]",InputProps:{style:{borderRadius:"8px",color:"#705396"},className:" input-bordered border-none w-full  text-[#705396] focus:border-gray-500 h-[48px]"}}}})})}):(0,s.jsx)("label",{className:"bg-[#F8F5FB] input input-bordered flex items-center gap-2 w-full",children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",value:_?_.format("DD-MM")+"-"+(_.year()+543):"",readOnly:!0})}),V.birthDate&&(0,s.jsx)("span",{className:"text-red-500",children:V.birthDate})]})})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{className:"w-1/2 pr-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"วันที่ลงทะเบียน"}),(0,s.jsx)("label",{className:" bg-[#F8F5FB] input input-bordered flex items-center gap-2 w-full",children:(0,s.jsx)("input",{type:"text",className:"grow pointer-events-none text-[#705396]",value:c().utc(t.patient.register_date).add(543,"years").format("DD-MM-YYYY HH:mm:ss"),readOnly:!0})})]})}),(0,s.jsx)("div",{className:"w-1/2 pl-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"วันนัดหมาย"}),l?(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"flex justify-between gap-2",children:[(0,s.jsxs)("div",{className:"w-[50%]",children:[(0,s.jsx)(w._,{dateAdapter:F.Z,adapterLocale:"th",children:(0,s.jsx)(N.O,{format:"DD-MM-YYYY",value:S,onChange:e=>C(e),slotProps:{textField:{fullWidth:!0,className:" text-[#705396] hover:border-gray-500 h-[48px]",InputProps:{style:{borderRadius:"8px",color:"#705396"},className:" input-bordered border-none w-full  text-[#705396] focus:border-gray-500 h-[48px]"}}}})}),V.appointmentDate&&(0,s.jsx)("span",{className:"text-red-500",children:V.appointmentDate})]}),(0,s.jsxs)("div",{className:"w-[50%]",children:[(0,s.jsx)(w._,{dateAdapter:y.Q,children:(0,s.jsx)(b.j,{value:Y,onChange:e=>M(e),slotProps:{textField:{fullWidth:!0,className:"rounded-lg text-[#705396] hover:border-gray-500 h-[48px]",InputProps:{style:{borderRadius:"8px",color:"#705396"},className:" input-bordered border-none w-full rounded-lg text-[#705396] focus:border-gray-500 h-[48px]"}}}})}),V.appointmentTime&&(0,s.jsx)("span",{className:"text-red-500",children:V.appointmentTime})]})]})}):(0,s.jsxs)("div",{className:"flex justify-between gap-2",children:[(0,s.jsx)("label",{className:"bg-[#F8F5FB] input input-bordered flex items-center gap-2 w-1/2",children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",value:S?S.format("DD-MM")+"-"+(S.year()+543):"",readOnly:!0})}),(0,s.jsx)("label",{className:"bg-[#F8F5FB] input input-bordered flex items-center gap-2 w-1/2",children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",value:Y?S.format(" HH:mm:ss"):"",readOnly:!0})})]})]})})]})]}),(0,s.jsxs)("div",{className:"my-2 relative  ".concat(ex?"w-full":"w-1/2 pr-4"),children:[(0,s.jsxs)("div",{className:"flex ".concat(ex?"h-[50px]":"h-[30px]"),children:[(0,s.jsx)("span",{className:"text-[#705396]  ".concat(ex?"flex items-center":""," "),children:ex?"ข้อความที่ต้องส่งวันที่ ".concat(c()().format("DD-MM-YYYY")):"เลือกยาที่ต้องหยุดรับประทาน"}),!ex&&l&&(0,s.jsx)("button",{className:"mx-2",onClick:()=>{E([...P,{id:Date.now(),name:"",dose:"",isOther:!1,isDoseOther:!1}])},children:(0,s.jsx)(m.default,{src:"/image/icon_addplus.png",alt:"add medication",width:30,height:30})})]}),U&&(0,s.jsx)("span",{className:"text-red-500",children:U}),(0,s.jsx)("div",{className:"rounded bg-[#E8DBF5] ".concat(U?"min-h-[36dvh] 2xl:min-h-[42dvh]":"min-h-[38dvh] 2xl:min-h-[44dvh]"," p-3"),children:ex?(0,s.jsx)("div",{className:"",children:t.daily_detail.filter(e=>c()(e.date_before_appointment).isSame(c()(),"day")).map((e,t)=>{var a;return(0,s.jsxs)("div",{className:"items-center m-2",children:[(0,s.jsx)("div",{className:"flex",children:null===(a=e.noti_image)||void 0===a?void 0:a.map((e,t)=>(0,s.jsx)(m.default,{src:e,width:100,height:100,alt:"notification image ".concat(t),className:"cursor-pointer max-w-[60px] 2xl:max-w-[80px] 2xl:h-[80px] object-cover rounded-lg mr-3",onClick:()=>window.open(e,"_blank")},t))}),(0,s.jsxs)("div",{className:"w-full text-[#705396] mt-2 flex flex-col",children:[(0,s.jsxs)("span",{className:"2xl:my-2",children:["แจ้งคุณ ",d," ",x]}),(0,s.jsx)("span",{className:"2xl:my-2",children:"ข้อควรปฏิบัติก่อนรับการตรวจส่องกล้องลำไส้ใหญ่"}),(0,s.jsx)("div",{className:" break-words max-h-[18dvh] 2xl:max-h-[30dvh] overflow-y-auto",dangerouslySetInnerHTML:{__html:(0,j.X1)(e.noti_detail)||""}})]}),(0,s.jsxs)("button",{onClick:()=>em(e),className:"absolute top-0 left-56 text-white w-38 font-light btn btn-active mx-4 bg-[#693092] ",children:[(0,s.jsx)(m.default,{className:"gap-1",src:"/image/icon_edit.png",alt:"logo",width:30,height:30}),(0,s.jsx)("span",{children:" Edit"})]})]},t)})}):(0,s.jsxs)("div",{children:[(0,s.jsxs)("span",{className:"text-[#705396]",children:[" รายการที่เลือก ",l?P.length:t.patient.med.length," รายการ"]}),(0,s.jsx)("div",{className:"".concat(U?"max-h-[34dvh] 2xl:max-h-[38dvh]":"max-h-[34dvh] 2xl:max-h-[40dvh]","  overflow-y-auto"),children:l?(0,s.jsx)("div",{children:P.map(e=>(0,s.jsxs)("div",{className:"flex justify-between pt-2",children:[e.isOther?(0,s.jsx)("input",{type:"text",className:"w-[70%] mx-1 h-[3rem] rounded bg-[#F8F5FB] text-center text-[#705396]",value:"other"===e.name?"":L[e.id]||e.name||"",onChange:t=>en(t,e.id),placeholder:"ระบุชื่อยา"}):(0,s.jsxs)("select",{className:"w-[70%] mx-1 h-[3rem] rounded bg-[#F8F5FB] text-center text-[#705396]",value:e.name,onChange:t=>el(t,e.id),children:[(0,s.jsx)("option",{value:"",disabled:!0,children:"เลือกยา"}),H.map(e=>(0,s.jsx)("option",{value:e.name,children:e.name},e.id)),(0,s.jsx)("option",{value:"other",children:"อื่นๆ"})]}),e.isDoseOther?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("input",{type:"text",className:"w-[20%] mx-1 h-[3rem] text-center rounded  text-[#705396]",value:"other"===e.dose?"":I[e.id]||e.dose||"",onChange:t=>{let a=t.target.value;/^\d*$/.test(a)&&ei(t,e.id)}}),(0,s.jsx)("span",{className:"flex items-center text-[#705396]",children:"วัน"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("select",{className:"w-[20%] mx-1 h-[3rem] rounded text-center text-[#705396]",value:e.dose,onChange:t=>er(t,e.id),children:[(0,s.jsx)("option",{value:"",disabled:!0,children:"โปรดเลือก"}),[...Array(7)].map((e,t)=>(0,s.jsx)("option",{value:t+1,children:t+1},t+1)),(0,s.jsx)("option",{value:"other",children:"อื่นๆ"})]}),(0,s.jsx)("div",{className:"flex items-center text-[#705396]",children:"วัน"})]}),(0,s.jsx)("button",{className:"mx-1",onClick:()=>es(e.id),children:(0,s.jsx)(m.default,{src:"/image/icon_delete.png",alt:"delete medication",width:30,height:30})})]},e.id))}):(0,s.jsx)("div",{children:P.map(e=>(0,s.jsxs)("div",{className:"flex justify-between pt-2",children:[e.isOther?(0,s.jsx)("input",{type:"text",className:"w-[70%] mx-1 h-[3rem] opacity-70 rounded bg-[#F8F5FB] text-center text-[#705396]",defaultValue:e.name,disabled:!0,placeholder:"ระบุชื่อยา"}):(0,s.jsx)("select",{className:"w-[70%] mx-1 h-[3rem] rounded bg-[#F8F5FB] text-center text-[#705396]",defaultValue:e.name,disabled:!0,children:(0,s.jsx)("option",{value:e.name,children:e.name})}),e.isDoseOther?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("input",{type:"text",className:"w-[20%] mx-1 h-[3rem] text-center opacity-70 rounded bg-[#F8F5FB] text-[#705396]",defaultValue:e.dose,disabled:!0}),(0,s.jsx)("div",{className:"flex items-center text-[#705396]",children:"วัน"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("select",{className:"w-[20%] mx-1 h-[3rem] rounded bg-[#F8F5FB] text-center text-[#705396]",defaultValue:e.dose,disabled:!0,children:(0,s.jsx)("option",{value:e.dose,children:e.dose})}),(0,s.jsx)("div",{className:"flex items-center text-[#705396]",children:"วัน"})]})]},e.id))})})]})})]})]}),(0,s.jsxs)("div",{className:" w-[45%]",children:[(0,s.jsxs)("div",{className:"flex pl-8",children:[(0,s.jsx)("div",{className:"w-[63.016%] ",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396] ",children:"Line Username"}),(0,s.jsx)("label",{className:"bg-[#F8F5FB] relative input input-bordered flex items-center gap-2 w-full",children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",value:k,readOnly:!0})})]})}),(0,s.jsx)("div",{className:"flex items-center pt-6",children:(0,s.jsx)("button",{onClick:ed,className:"relative text-white font-light bg-[#693092] btn btn-active mx-3",children:(0,s.jsx)(m.default,{src:"/image/icon_refresh.png",alt:"logo",width:30,height:30})})})]}),(0,s.jsx)(g,{visit_id:t.patient.visit_id,dailyDetail:t.daily_detail,notilist:G}),(0,s.jsx)(p,{isVisible:J,onClose:()=>{Q(!1),ee(q&&q.noti_detail||"")},title:"รายละเอียดการแจ้งเตือน",children:q&&(0,s.jsxs)("div",{className:"p-5",children:[(0,s.jsxs)("div",{className:"text-2xl text-[#5955B3] font-semibold",children:["แจ้งเตือนคุณ ",q.ptname]}),(0,s.jsxs)("div",{className:"text-2xl text-[#5955B3] font-semibold",children:["วันที่ ",c()(q.date_before_appointment).format("DD-MM-")+(c()(q.date_before_appointment).year()+543)]}),(0,s.jsxs)("div",{className:"rounded bg-white min-h-[40dvh] 2xl:min-h-[48dvh] py-2 mt-2 text-xl mb-16",children:[(0,s.jsxs)("select",{className:"w-full mb-4 p-2 border rounded text-base",value:et,onChange:e=>{let t=parseInt(e.target.value,10);ea(t);let a=G.find(e=>e.id===t);ee(a?a.detail:"")},children:[(0,s.jsx)("option",{value:0,disabled:!0,children:"เลือกการแจ้งเตือน"}),G.map(e=>(0,s.jsx)("option",{value:e.id,children:e.header},e.id))]}),(0,s.jsx)(D,{className:"h-[280px] 2xl:h-[360px]",value:K,onChange:e=>ee(e),theme:"snow"})]}),!c()(q.date_before_appointment).isBefore(c()(),"day")&&(0,s.jsx)("div",{className:"flex justify-center mt-4",children:(0,s.jsxs)("button",{onClick:ep,className:"relative text-white w-38 font-light btn btn-active mx-4 bg-[#693092]",children:[(0,s.jsx)(m.default,{className:"gap-2",src:"/image/icon_save.png",alt:"logo",width:30,height:30}),(0,s.jsx)("span",{children:"Save"})]})})]})})]})]})]})})})};c().locale("th");var S=e=>{let{items:t}=e,a=(0,i.useRouter)(),[l,d]=(0,n.useState)(!1),[o,x]=(0,n.useState)(t.patient.patient_fname),[p,h]=(0,n.useState)(t.patient.patient_lname),[f,v]=(0,n.useState)(t.patient.id_card),[_,D]=(0,n.useState)(B()(t.patient.dob)),[O,S]=(0,n.useState)(""),[C,Y]=(0,n.useState)(B()(t.patient.appointment_date)),[M,k]=(0,n.useState)(c()(t.patient.appointment_time,"HH:mm")),[T,P]=(0,n.useState)(t.patient.line_name),[E,H]=(0,n.useState)([]),[Z,L]=(0,n.useState)([]),[A,I]=(0,n.useState)({}),[R,V]=(0,n.useState)({}),[W,U]=(0,n.useState)({}),[$,G]=(0,n.useState)(""),[X,J]=(0,n.useState)([]);(0,n.useEffect)(()=>{l||Y(B()("".concat(t.patient.appointment_date.split("T")[0],"T").concat(t.patient.appointment_time))),(async()=>{try{let e=(await r.Z.get("".concat("https://colonoscopytuh.com/backend/api/","medical"))).data;if(L(e),t.patient.med){let a=t.patient.med.map((t,a)=>{let s=e.some(e=>e.name===t.medic),l=/^[1-7]$/.test(t.val);return{id:a,name:t.medic,dose:t.val,isOther:!s,isDoseOther:!l}});H(a)}}catch(e){console.error("Error fetching medical data:",e)}})();let e=setInterval(()=>{S((0,j.eF)())},1e3);return()=>clearInterval(e)},[t.patient.appointment_date,t.patient.appointment_time,t.patient.med,l]);let Q=e=>{H(E.filter(t=>t.id!==e))},q=(e,t)=>{let a=e.target.value;E.some(e=>e.name===a&&e.id!==t&&"other"!==a)?u().fire({title:"ขออภัย",text:"รายการยานี้ถูกเลือกแล้ว",icon:"error",confirmButtonText:"ปิด",customClass:{icon:"custom-swal2-error"}}):H(E.map(e=>{if(e.id===t){let t="other"===a||!Z.some(e=>e.name===a);return{...e,name:a,isOther:t}}return e}))},z=(e,t)=>{I({...A,[t]:e.target.value}),H(E.map(a=>a.id===t?{...a,name:e.target.value}:a))},K=(e,t)=>{V({...R,[t]:e.target.value}),H(E.map(a=>a.id===t?{...a,dose:e.target.value}:a))},ee=(e,t)=>{let a=e.target.value;H(E.map(e=>e.id===t?{...e,dose:a,isDoseOther:"other"===a}:e))},et=async()=>{let e={visit_id:t.patient.visit_id,userId:t.patient.line_id};try{let t=await r.Z.post("".concat("https://colonoscopytuh.com/backend/api/","visit/line/renew"),e);200===t.status?P(t.data.line_name):console.error("Failed to refresh data")}catch(e){console.error("Error while refreshing data:",e)}},ea=async()=>{let e=E.some(e=>!e.name||!e.dose),t=B()().startOf("day"),a=_?B()(_).startOf("day"):null,s=a?t.diff(a,"year"):null;if(e){G("กรุณากรอกข้อมูลยาและจำนวนวันที่รับประทานให้ครบถ้วน");return}G("");let l={};if(o.trim()||(l.firstname="กรุณากรอกชื่อ"),p.trim()||(l.lastname="กรุณากรอกนามสกุล"),f.trim()?13!==f.trim().length&&(l.idCard="กรุณากรอกบัตรประจำตัวประชาชนให้ถูกต้อง (13 หลัก)"):l.idCard="กรุณากรอกบัตรประจำตัวประชาชน",_?(null===s||s<1)&&(l.birthDate="กรุณากรอกวันเดือนปีเกิดที่มากกว่าหรือเท่ากับ 1 ปี"):l.birthDate="กรุณากรอกวันเดือนปีเกิด",M||(l.appointmentTime="กรุณากรอกเวลานัดหมาย"),C?5>B()(C).startOf("day").diff(t,"days")&&(l.appointmentDate="กรุณากรอกวันนัดหมายที่มากกว่าวันปัจจุบัน 5 วัน"):l.appointmentDate="กรุณากรอกวันนัดหมาย",Object.keys(l).length>0){U(l);return}U({}),await es()},es=async()=>{let e=JSON.stringify(E.map(e=>({val:e.dose,medic:e.name}))),s=new FormData;s.append("fname",o),s.append("lname",p),s.append("idcard",f),s.append("dob",_?_.format("YYYY-MM-DD"):""),s.append("appointment_date",C?C.format("YYYY-MM-DD"):""),s.append("appointment_time",M?M.format("HH:mm:ss"):""),s.append("med",e),s.append("patient_id",t.patient.patient_id.toString());try{let e=await r.Z.post("".concat("https://colonoscopytuh.com/backend/api/","visit/newappointment"),s);200===e.status?u().fire({title:"สำเร็จ",text:"คุณได้ทำรายการเรียบร้อยแล้ว",icon:"success",confirmButtonText:"ปิด"}).then(()=>{a.push("/home/patient/view-patient?id=".concat(e.data.visit_id))}):u().fire({title:"ขออภัย",text:"คุณทำรายการไม่ถูกต้อง กรุณาตรวจสอบใหม่อีกครั้ง",icon:"warning",confirmButtonText:"ปิด",customClass:{icon:"custom-swal2-warning"}})}catch(e){console.error("Error saving data:",e),u().fire({title:"ขออภัย",text:"เกิดข้อผิดพลาดในการบันทึกข้อมูล กรุณาลองใหม่อีกครั้ง",icon:"error",confirmButtonText:"ปิด",customClass:{icon:"custom-swal2-error"}})}};return(0,s.jsx)("div",{className:"px-8",children:(0,s.jsx)("div",{className:"h-full w-full rounded-[15px] bg-white p-5 ",children:(0,s.jsxs)("div",{className:"min-h-[81.71dvh] flex flex-col",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{children:(0,s.jsx)("div",{className:"text-xl 2xl:text-2xl text-[#5955B3] font-semibold",children:l?"กำหนดการใหม่":"ตรวจสำเร็จแล้ว"})}),(0,s.jsx)("div",{className:"flex",children:(0,s.jsxs)("button",{onClick:l?ea:()=>{d(!0)},className:"relative text-white w-38 font-light btn btn-active mx-4 bg-[#693092]",children:[(0,s.jsx)(m.default,{className:"gap-2",src:l?"/image/icon_save.png":"/image/icon_new_appointment.png",alt:"logo",width:30,height:30}),(0,s.jsx)("span",{children:l?"Save":"New Appointment"})]})})]}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsxs)("div",{className:" w-[55%]",children:[(0,s.jsxs)("form",{action:"",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{className:"w-1/2 pr-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"ชื่อ"}),(0,s.jsx)("label",{className:"".concat(l?"bg-white":"bg-[#F8F5FB]","  input input-bordered flex items-center gap-2 w-full"),children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",readOnly:!l,value:o,onChange:e=>x(e.target.value)})})]})}),(0,s.jsx)("div",{className:"w-1/2 pl-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396] ",children:"นามสกุล"}),(0,s.jsx)("label",{className:"".concat(l?"bg-white":"bg-[#F8F5FB]","  input input-bordered flex items-center gap-2 w-full"),children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",readOnly:!l,value:p,onChange:e=>h(e.target.value)})}),W.lastname&&(0,s.jsx)("span",{className:"text-red-500",children:W.lastname})]})})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{className:"w-1/2 pr-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"เลขที่บัตรประจำตัวประชาชน"}),(0,s.jsx)("label",{className:"".concat(l?"bg-white":"bg-[#F8F5FB]","  input input-bordered flex items-center gap-2 w-full"),children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",value:f,maxLength:13,pattern:"\\d{13}",readOnly:!l,onChange:e=>v(e.target.value)})}),W.idCard&&(0,s.jsx)("span",{className:"text-red-500",children:W.idCard})]})}),(0,s.jsx)("div",{className:"w-1/2 pl-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"วันเดือนปีเกิด"}),l?(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(w._,{dateAdapter:F.Z,adapterLocale:"th",children:(0,s.jsx)(N.O,{format:"DD-MM-YYYY",value:_,onChange:e=>D(e),slotProps:{textField:{fullWidth:!0,className:" text-[#705396] hover:border-gray-500 h-[48px]",InputProps:{style:{borderRadius:"8px",color:"#705396"},className:" input-bordered border-none w-full  text-[#705396] focus:border-gray-500 h-[48px]"}}}})})}):(0,s.jsx)("label",{className:"bg-[#F8F5FB] input input-bordered flex items-center gap-2 w-full",children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",value:_?_.format("DD-MM")+"-"+(_.year()+543):"",readOnly:!0})}),W.birthDate&&(0,s.jsx)("span",{className:"text-red-500",children:W.birthDate})]})})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{className:"w-1/2 pr-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"วันที่ลงทะเบียน"}),(0,s.jsx)("label",{className:" bg-[#F8F5FB] input input-bordered flex items-center gap-2 w-full",children:(0,s.jsx)("input",{type:"text",className:"grow pointer-events-none text-[#705396]",value:l?O:c().utc(t.patient.register_date).add(543,"years").format("DD-MM-YYYY HH:mm:ss"),readOnly:!0})})]})}),(0,s.jsx)("div",{className:"w-1/2 pl-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"วันนัดหมาย"}),l?(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"flex justify-between gap-2",children:[(0,s.jsxs)("div",{className:"w-[50%]",children:[(0,s.jsx)(w._,{dateAdapter:F.Z,adapterLocale:"th",children:(0,s.jsx)(N.O,{format:"DD-MM-YYYY",value:C,onChange:e=>Y(e),slotProps:{textField:{fullWidth:!0,className:" text-[#705396] hover:border-gray-500 h-[48px]",InputProps:{style:{borderRadius:"8px",color:"#705396"},className:" input-bordered border-none w-full  text-[#705396] focus:border-gray-500 h-[48px]"}}}})}),W.appointmentDate&&(0,s.jsx)("span",{className:"text-red-500",children:W.appointmentDate})]}),(0,s.jsxs)("div",{className:"w-[50%]",children:[(0,s.jsx)(w._,{dateAdapter:y.Q,children:(0,s.jsx)(b.j,{value:M,onChange:e=>k(e),slotProps:{textField:{fullWidth:!0,className:"rounded-lg text-[#705396] hover:border-gray-500 h-[48px]",InputProps:{style:{borderRadius:"8px",color:"#705396"},className:" input-bordered border-none w-full rounded-lg text-[#705396] focus:border-gray-500 h-[48px]"}}}})}),W.appointmentTime&&(0,s.jsx)("span",{className:"text-red-500",children:W.appointmentTime})]})]})}):(0,s.jsxs)("div",{className:"flex justify-between gap-2",children:[(0,s.jsx)("label",{className:"bg-[#F8F5FB] input input-bordered flex items-center gap-2 w-1/2",children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",value:C?C.format("DD-MM")+"-"+(C.year()+543):"",readOnly:!0})}),(0,s.jsx)("label",{className:"bg-[#F8F5FB] input input-bordered flex items-center gap-2 w-1/2",children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",value:M?C.format(" HH:mm:ss"):"",readOnly:!0})})]})]})})]})]}),(0,s.jsxs)("div",{className:"my-2 w-1/2 pr-4",children:[(0,s.jsxs)("div",{className:"flex h-[30px]",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"เลือกยาที่ต้องหยุดรับประทาน"}),l&&(0,s.jsx)("button",{className:"mx-2",onClick:()=>{H([...E,{id:Date.now(),name:"",dose:"",isOther:!1,isDoseOther:!1}])},children:(0,s.jsx)(m.default,{src:"/image/icon_addplus.png",alt:"add medication",width:30,height:30})})]}),$&&(0,s.jsx)("span",{className:"text-red-500",children:$}),(0,s.jsxs)("div",{className:"rounded bg-[#E8DBF5] ".concat($?"min-h-[38dvh] 2xl:min-h-[44dvh]":"min-h-[40dvh] 2xl:min-h-[46dvh]"," p-3"),children:[(0,s.jsxs)("span",{className:"text-[#705396]",children:[" รายการที่เลือก ",l?E.length:t.patient.med.length," รายการ"]}),(0,s.jsx)("div",{className:"".concat($?"max-h-[34dvh] 2xl:max-h-[38dvh]":"max-h-[34dvh] 2xl:max-h-[40dvh]"," overflow-y-auto"),children:l?(0,s.jsx)("div",{children:E.map(e=>(0,s.jsxs)("div",{className:"flex justify-between pt-2",children:[e.isOther?(0,s.jsx)("input",{type:"text",className:"w-[70%] mx-1 h-[3rem] rounded bg-[#F8F5FB] text-center text-[#705396]",value:"other"===e.name?"":A[e.id]||e.name||"",onChange:t=>z(t,e.id),placeholder:"ระบุชื่อยา"}):(0,s.jsxs)("select",{className:"w-[70%] mx-1 h-[3rem] rounded bg-[#F8F5FB] text-center text-[#705396]",value:e.name,onChange:t=>q(t,e.id),children:[(0,s.jsx)("option",{value:"",disabled:!0,children:"เลือกยา"}),Z.map(e=>(0,s.jsx)("option",{value:e.name,children:e.name},e.id)),(0,s.jsx)("option",{value:"other",children:"อื่นๆ"})]}),e.isDoseOther?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("input",{type:"text",className:"w-[20%] mx-1 h-[3rem] text-center rounded  text-[#705396]",value:"other"===e.dose?"":R[e.id]||e.dose||"",onChange:t=>{let a=t.target.value;/^\d*$/.test(a)&&K(t,e.id)}}),(0,s.jsx)("span",{className:"flex items-center text-[#705396]",children:"วัน"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("select",{className:"w-[20%] mx-1 h-[3rem] rounded text-center text-[#705396]",value:e.dose,onChange:t=>ee(t,e.id),children:[(0,s.jsx)("option",{value:"",disabled:!0,children:"โปรดเลือก"}),[...Array(7)].map((e,t)=>(0,s.jsx)("option",{value:t+1,children:t+1},t+1)),(0,s.jsx)("option",{value:"other",children:"อื่นๆ"})]}),(0,s.jsx)("div",{className:"flex items-center text-[#705396]",children:"วัน"})]}),(0,s.jsx)("button",{className:"mx-1",onClick:()=>Q(e.id),children:(0,s.jsx)(m.default,{src:"/image/icon_delete.png",alt:"delete medication",width:30,height:30})})]},e.id))}):(0,s.jsx)("div",{children:E.map(e=>(0,s.jsxs)("div",{className:"flex justify-between pt-2",children:[e.isOther?(0,s.jsx)("input",{type:"text",className:"w-[70%] mx-1 h-[3rem] opacity-70 rounded bg-[#F8F5FB] text-center text-[#705396]",defaultValue:e.name,disabled:!0,placeholder:"ระบุชื่อยา"}):(0,s.jsx)("select",{className:"w-[70%] mx-1 h-[3rem] rounded bg-[#F8F5FB] text-center text-[#705396]",defaultValue:e.name,disabled:!0,children:(0,s.jsx)("option",{value:e.name,children:e.name})}),e.isDoseOther?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("input",{type:"text",className:"w-[20%] mx-1 h-[3rem] text-center opacity-70 rounded bg-[#F8F5FB] text-[#705396]",defaultValue:e.dose,disabled:!0}),(0,s.jsx)("div",{className:"flex items-center text-[#705396]",children:"วัน"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("select",{className:"w-[20%] mx-1 h-[3rem] rounded bg-[#F8F5FB] text-center text-[#705396]",defaultValue:e.dose,disabled:!0,children:(0,s.jsx)("option",{value:e.dose,children:e.dose})}),(0,s.jsx)("div",{className:"flex items-center text-[#705396]",children:"วัน"})]})]},e.id))})})]})]})]}),(0,s.jsxs)("div",{className:" w-[45%]",children:[(0,s.jsxs)("div",{className:"flex pl-8",children:[(0,s.jsx)("div",{className:"w-[63.016%] ",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396] ",children:"Line Username"}),(0,s.jsx)("label",{className:"bg-[#F8F5FB] relative input input-bordered flex items-center gap-2 w-full",children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",value:T,readOnly:!0})})]})}),(0,s.jsx)("div",{className:"flex items-center pt-6",children:(0,s.jsx)("button",{onClick:et,className:"relative text-white font-light bg-[#693092] btn btn-active mx-3",children:(0,s.jsx)(m.default,{src:"/image/icon_refresh.png",alt:"logo",width:30,height:30})})})]}),!l&&(0,s.jsx)(g,{visit_id:t.patient.visit_id,dailyDetail:t.daily_detail,notilist:X})]})]})]})})})},C=a(44785),Y=function(){let e=(0,i.useSearchParams)(),[t,a]=(0,n.useState)(""),[d,c]=(0,n.useState)(null),[m,p]=(0,n.useState)(!0),h=(0,i.useRouter)();(0,n.useEffect)(()=>{C.Z.get("__user")||h.push("/")},[h]);let u=(0,n.useCallback)(async()=>{try{var t;let s=e.get("id"),l=await r.Z.get("".concat("https://colonoscopytuh.com/backend/api/","visit/task/").concat(s));c(l.data);let n=null===(t=l.data.patient)||void 0===t?void 0:t.state;"string"==typeof n&&a(n)}catch(e){console.error("Error fetching data:",e)}finally{p(!1)}},[e]);return((0,n.useEffect)(()=>{e.get("id")?u():p(!1)},[e,u]),m)?(0,s.jsxs)("div",{className:"min-h-screen",children:[(0,s.jsx)(l.Z,{}),"OTP"===t?(0,s.jsx)(x.Z,{}):(0,s.jsx)(x.o,{})]}):(0,s.jsxs)("div",{className:"min-h-screen",children:[(0,s.jsx)(l.Z,{}),"OTP"===t?d&&(0,s.jsx)(o,{items:d}):"Registered"===t?d&&(0,s.jsx)(O,{items:d,fetchDataview:u}):d&&(0,s.jsx)(S,{items:d})]})}},86504:function(e,t,a){"use strict";var s=a(57437);a(2265);var l=a(66648),n=a(87138),i=a(64379),r=a.n(i),d=a(16463),c=a(44785);t.Z=()=>{let e=(0,d.useRouter)(),t=(0,d.usePathname)();return(0,s.jsx)("div",{className:"p-8 pt-3 2xl:pt-8 pb-2",children:(0,s.jsxs)("div",{className:" rounded-[15px] bg-white px-2 py-1 flex justify-between",children:[(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)(l.default,{src:"/image/logo_colonoscopy_small.png",alt:"logo",width:64,height:64,className:"2xl:w-20"}),(0,s.jsx)("div",{className:"flex items-center text-xl text-[#9b88c0] font-medium select-none ",children:(0,s.jsx)("h1",{children:"COLONOSCOPY TUH"})}),(0,s.jsxs)(n.default,{href:"".concat("/","home"),className:"ml-10 text-[#461F78] flex items-center text-xl font-bold select-none",children:[(0,s.jsx)("div",{children:(0,s.jsx)(l.default,{src:"/image/icon_home.png",alt:"logo",width:30,height:30})}),(0,s.jsx)("h1",{className:"mx-2",children:"หน้าหลัก"})]}),(0,s.jsxs)(n.default,{href:"#",onClick:a=>{a.preventDefault(),"/home/"===t?e.push("/home/"):e.back()},className:"mx-5 text-[#461F78] flex items-center text-xl font-bold select-none",children:[(0,s.jsx)("div",{children:(0,s.jsx)(l.default,{src:"/image/icon_back.png",alt:"logo",width:30,height:30})}),(0,s.jsx)("h1",{className:"mx-2",children:"ย้อนกลับ"})]})]}),(0,s.jsx)("div",{className:"flex",children:(0,s.jsxs)("div",{onClick:e=>{e.preventDefault(),r().fire({title:"ยืนยันการออกจากระบบ",text:"คุณกำลังออกจากระบบ ต้องการดำเนินการต่อหรือไม่ ?",icon:"warning",showCancelButton:!0,cancelButtonText:"ยกเลิก",confirmButtonText:"ยืนยัน",reverseButtons:!1,customClass:{icon:"custom-swal2-warning"}}).then(e=>{e.isConfirmed&&r().fire({title:"ออกจากระบบ!",text:"คุณได้ออกจากระบบแล้ว",icon:"success",confirmButtonText:"ปิด"}).then(()=>{c.Z.remove("__user"),window.location.href="".concat("/")})})},className:"cursor-pointer mx-16 text-[#461F78] flex items-center text-xl font-bold select-none",children:[(0,s.jsx)("div",{children:(0,s.jsx)(l.default,{src:"/image/icon_out.png",alt:"logo",width:30,height:30})}),(0,s.jsx)("h1",{className:"mx-2",children:"ออกจากระบบ"})]})})]})})}},50448:function(e,t,a){"use strict";a.d(t,{X1:function(){return l},eF:function(){return s}});let s=()=>{let e=new Date(new Date().getTime()),t=e.getFullYear()+543,a=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0"),l=String(e.getHours()).padStart(2,"0"),n=String(e.getMinutes()).padStart(2,"0"),i=String(e.getSeconds()).padStart(2,"0");return"".concat(s,"-").concat(a,"-").concat(t," ").concat(l,":").concat(n,":").concat(i)},l=e=>e.replace(/<p>\s*<br\s*\/?>\s*<\/p>/g,"").replace(/<p>/g,"<span>").replace(/<\/p>/g,"</span><br>").replace(/<\/?strong>/g,"")},46797:function(e,t,a){"use strict";a.d(t,{o:function(){return l}});var s=a(57437);t.Z=()=>(0,s.jsx)("div",{className:"px-8",children:(0,s.jsx)("div",{className:"h-full w-full rounded-[15px] bg-white p-5 flex justify-center",children:(0,s.jsxs)("div",{className:"min-h-[81.71dvh] w-[70%] flex flex-col",children:[(0,s.jsx)("div",{children:(0,s.jsx)("div",{className:"text-2xl text-[#5955B3] font-semibold",children:"เพิ่มผู้ป่วยใหม่"})}),(0,s.jsxs)("form",{action:"",className:" mt-2",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{className:"w-1/2 pr-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"ชื่อ"}),(0,s.jsx)("label",{className:"input input-bordered flex items-center gap-2 w-full",children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",readOnly:!0})})]})}),(0,s.jsx)("div",{className:"w-1/2 pl-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"นามสกุล"}),(0,s.jsx)("label",{className:"input input-bordered flex items-center gap-2 w-full",children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",readOnly:!0})})]})})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{className:"w-1/2 pr-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"เลขที่บัตรประจำตัวประชาชน"}),(0,s.jsx)("label",{className:"input input-bordered flex items-center gap-2 w-full",children:(0,s.jsx)("input",{type:"text",className:"grow text-[#705396]",maxLength:13,pattern:"\\d{13}",readOnly:!0})})]})}),(0,s.jsx)("div",{className:"w-1/2 pl-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"วันเดือนปีเกิด"}),(0,s.jsx)("label",{className:"input input-bordered flex items-center gap-2 w-full",children:(0,s.jsx)("input",{type:"date",className:"grow text-[#705396]",readOnly:!0})})]})})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("div",{className:"w-1/2 pr-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"วันที่ลงทะเบียน"}),(0,s.jsx)("label",{className:" bg-[#F8F5FB] input input-bordered flex items-center gap-2 w-full",children:(0,s.jsx)("input",{type:"text",className:"grow pointer-events-none text-[#705396]",readOnly:!0})})]})}),(0,s.jsx)("div",{className:"w-1/2 pl-4",children:(0,s.jsxs)("div",{className:"my-2",children:[(0,s.jsx)("span",{className:"text-[#705396]",children:"วันนัดหมาย"}),(0,s.jsx)("label",{className:"input input-bordered flex items-center gap-2 w-full",children:(0,s.jsx)("input",{type:"datetime-local",className:"grow text-[#705396]",readOnly:!0})})]})})]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsxs)("div",{className:"my-2 w-1/2 pr-4",children:[(0,s.jsx)("div",{className:"flex",children:(0,s.jsx)("span",{className:"text-[#705396]",children:"เลือกยาที่ควรหยุดรับประทาน"})}),(0,s.jsx)("div",{className:"rounded bg-[#E8DBF5] min-h-[49dvh] p-3",children:(0,s.jsx)("span",{className:"text-[#705396]",children:" รายการที่เลือก 0 รายการ"})})]}),(0,s.jsx)("div",{className:"w-1/2 pl-4 flex justify-center items-center",children:(0,s.jsxs)("div",{className:"text-center w-1/2",children:[(0,s.jsx)("div",{className:"text-[#461F78] text-3xl font-semibold my-2",children:"OTP"}),(0,s.jsx)("div",{className:"text-[#705396] my-2",children:"รหัสนี้ใช้สำหรับลงทะเบียนผู้ใช้งาน Line OA"}),(0,s.jsx)("div",{className:"p-10 bg-[#F8F5FB] my-2",children:(0,s.jsx)("span",{className:"text-[#7F57D0] text-4xl tracking-widest"})})]})})]})]})})});let l=()=>(0,s.jsx)("div",{className:"px-8",children:(0,s.jsx)("div",{className:"h-full w-full rounded-[15px] bg-white p-5 ",children:(0,s.jsx)("div",{className:"min-h-[81.71dvh] flex flex-col"})})})},84721:function(e,t,a){"use strict";a.d(t,{Z:function(){return d}}),a(80473);var s=a(62737),l=a.n(s),n=a(41925),i=a.n(n),r=a(5069);l().extend(i());class d extends r.y{constructor({locale:e,formats:t}){super({locale:e,formats:t}),this.formatByString=(e,t)=>{let a=t.replace(/\bYYYY\b/g,"BBBB");return this.dayjs(e).format(a)}}}},18416:function(){}},function(e){e.O(0,[325,461,990,236,648,495,673,971,23,744],function(){return e(e.s=68259)}),_N_E=e.O()}]);